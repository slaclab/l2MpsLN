# Release notes

Release notes for the SLAC LCLS-II HPS MPS Link Node

## Releases:
* __l2MpsLN-R3-6-2__: 2020-06-17 J. Mock
  * Add PK and PD WTH and DEL PVs to autosave so the calibrated values don't get lost
* __l2MpsLN-R3-6-1__: 2020-05-20 J. Mock
  * Upgrade iocAdmin to version R3.1.16-1.3.0 to deal with timezone PV problem
  * Add seq version R2.2.4-1.2 to RELEASE. Load devSeqCar.dbd and lib devSeqCar seq pv
      in the src/Makefile to load the devSeqCar.db file for Accelerator network screens
  * Change the macro for autosave from ${L2MPS_PREFIX} to ${IOC_NAME} to conform with
      Accelerator Network common screens.  Changed in link_node.cmd and application_node.cmd
  * Comment in TPR Pattern load in application_node.cmd - this was a mistake in R3-6-0
  * Add sioc-b084-mp03 to run on shm-b084-hp04 slot 2 on cpu-b084-hp03 - BLEN/BCM test stand

* __l2MpsLN-R3-6-0__: 2020-05-14 J. Mock
  * Add support for PV inputs to MPS Digital APP (i.e. soft inputs) (#37, #38)
    * Update l2Mps to version R3.4.1
    * Update l2MpsAsyn to version R3.4.1
  * Merge Application Node support into this App
    * Add firmware/mpsAN.dict
    * Add l2MpsLNApp/Db/mpsAN.substitutions
    * Add iocBoot/common/application_node.cmd
  * Create directory for useful MPS LN scripts
    * Add init_lcls1_timins.sh which sets up the TPR for NC operation
    * Add mps_link_node_change_units.py which changes the units of an analog input
    * Add setupBPClock.sh which initializes the SALT settings for the crate
  * Update firmware to latest release
    * LN - AmcCarrierMpsAnalogLinkNode-0x00000049-20200423162244-leosap-fba853c.mcs
    * AN - AmcCarrierMpsApplicationNode-0x00000001-20200423162251-leosap-fba853c.mcs
  * Convert all the analog core PVs to mV units (#25)
  * Convert the processing window PVs to ns (#28, #31)
  * Fix parameter types used with YCPSWASYN (#29)
    Update YCPSWASYN to version R3.3.3 which includes bug fixes needed related to
    wrong parameter types. Also, fix some parameters types which didn't match the
    register type they were connected to.
  * Fix LCLS1 BSA implementation (#30).
    Fix several issues with the LCLS1 BSA implementation:
    * It was missing the tprPattern, and the evrClient EPICS modules,
    * There was also a bug in the stream data processing, as it was not considering the
      packetizer header and footer which were added since the initial BSA driver
      implementation.
    I also rename the BSA PV for more clarity. Instead of using index (0..23), use Bay
    number, channel number, and integration number.
  * Bring TPR BSA drivers into link_node.cmd (#32)
  * Analog Values Autosave (#34)
    Add autosave of EGU, EGUF, and EGUL for analog core values associated with analog
    inputs. Add script to iocBoot/common to change these values.
  * Bug fix: remove hard-coded name used to load the `bsaATTREdef.db` (#33, #35)

* __l2MpsLN-R3-5-0__: 2020-03-06 J. Mock
  * general ioc cleanup
  * change default yaml load to be from FW
  * add common/configs/specifics.yaml to set timing settings
  * add ${IOC}/configs/specifics.yaml to set LC1 kicker magnet type

* __l2MpsLN-R3-4-0__: 2020-02-07 J. Vasquez
  * Update versions:
  * buildroot to 2019.08
  * CPSW to R4.4.1
  * l2Mps to R3.3.0
  * yamlReader to R1.2.0
  * deviceLibrary to R1.2.0
  * hpsTpr to R1.1.0
  * asyn to R4.32-1.0.0
  * yamlLoader to R2.1.0
  * l2MpsAsyn to R3.3.0
  * ycpswasyn to R3.3.1
  * yamlDownloader to R1.2.0
  * tprTrigger to R1.5.0
  * BsaCore to R1.5.3

* __l2MpsLN-R3-3-0__: 2020-02-07 J. Vasquez
  * Add support to read raw waveforms from all ADC channels.
  * Bug fix: Add missing env vars to the local database `mps.env` file.
  * Update st.mcd for correct slot and crate for cu area.
  * Update default configuration files.
  * Update MCS file with current version `1cd2cbf`.

* __l2MpsLN-R3-2-0__: 2019-12-17 J. Vasquez
  * Merge `R2-branch` back into master.
  * Update both l2Mps and l2MpsAsyn to version `R3.2.0`.
  * Re-enable the `DownloadYamlFile` module.
  * Migrate application to EPICS v7.

* __l2MpsLN-R3-1-0__: 2019-09-24 J. Vasquez
  * Add PVs for new FW register related to LCLS1
    operation: Analog core register used on LCLS1
    mode.
  * Add PVs for the new FW module ASM Core.
  * Removed deprecated PVs for the Analog core
    peak detect enable and values, and add PVs for
    the new PrcValueSelect and ForcePrcVals registers.
  *  Update CPSW framework to version R4.2.0, and all the dependent modules:
    * l2Mps to R3.1.0,
    * yamlReader to R1.1.1,
    * deviceLibrary to R1.1.1,
    * yamlLoader to R1.1.4,
    * yamlDownloader to R1.1.1,
    * yCPSWAsyn to R3.1.2, and
    * l2MpsAsyn to R3.1.1

* __l2MpsLN-R3-0-0__: 2019-07-31 J. Vasquez
  * Update l2Mps to version R3.0.0 and l2MpsAsyn to version
    R3.0.0.
  * The IOC now read the EPICS database definition and firmware
    configuration files generated by the MPS database. We are
    using local copy in this application at this moment for testing.
  * The IOC now contacts the MPS manager at boot to request for its
    thresholds PVs to be set.

* __l2MpsLN-R2-6-0__: 2019-11-25 J. Vasquez
  * Update cpsw/framework to version R4.3.1.
  * Add the directory 'firmware/yaml_fixes' and add it to the CPSW's
    "YAML_PATH" environmental variable, to override YAML files coming
    from the FPGA.
  * Update PVs for the AnaloCore device.
  * Rename PV related to the LCLS2 Analog core. Added "LC2_" to be
    consistent with the LCLS1 Analog core PVs.
  * Update MCS file to current version.
  * Add new PVs for the Concentrator device.
  * Add support for the tprTrigger EPICS module.
  * Add support for the BsaCore module.
  * Process the firmware data stream with LCLS1 BSA data, and send it
    to BsaCore.
  * Update PVs for the mitigation core device, including adding a new PV
    for selection the type of mitigation kicker.
  * Minor bug fixes.

* __l2MpsLN-R2-5-0__: 2019-09-24 J. Vasquez
  * Update CPSW framework to version R4.2.0, and all the dependent modules:
    * l2Mps to R2.2.0,
    * yamlReader to R1.1.1,
    * deviceLibrary to R1.1.1,
    * yamlLoader to R1.1.4,
    * yamlDownloader to R1.1.1,
    * yCPSWAsyn to R3.1.2, and
    * l2MpsAsyn to R2.4.0

* __l2MpsLN-R2-4-0__: 2019-09-23 J. Vasquez
  * Add PVs for new FW register related to LCLS1
    operation: Analog core register used on LCLS1
    mode.
  * Add PVs for the new FW module ASM Core.
  * Removed deprecated PVs for the Analog core
    peak detect enable and values, and add PVs for
    the new PrcValueSelect and ForcePrcVals registers.

* __l2MpsLN-R2-3-3__: 2020-05-26 J. Vasquez
  * Udate the LN used in EIC to buildroot 2019.08.
    This includes update the following:
    * Packages:
      * cpsw/framework -> R4.4.1
      * l2Mps -> R2.4.0
      * yamlReader -> R1.2.0
      * deviceLibrary -> R1.2.0
    * EPICS modules:
      * asyn -> R4.32-1.0.0
      * yamlLoader -> R2.1.0
      * yamlDownloader -> R1.2.0
      * ycpswssyn -> R3.3.1
      * l2MpsAsyn -> R2.6.0
  * Added a local copy of the FW YAML files, as this
    old version has some bugs which are catch by the
    new CPSW version. The bugs in the local copy were
    manually fixed.
  * Disabled the yamlDownloader, and use the local
    copy of the YAML files.

* __l2MpsLN-R2-3-2__: 2019-08-16 J. Vasquez
  * Update l2MpsAsyn top version R2.3.2.

* __l2MpsLN-R2-3-1__: 2019-08-13 J. Vasquez
  * Update l2Mps top version R2.1.2 and l2MpsAsyn
    to version R2.3.1. Those versions includes a
    bug fix where an argument name was shadowing
    the protected member name. This was causing
    the polling thread to consume a lot of CPU.

* __l2MpsLN-R2-3-0__: 2019-07-18 J. Vasquez
  * Update the folllwing packages:
    * cpsw/framework -> R4.1.2
    * l2Mps -> R2.1.1
    * yamlReader -> R1.1.0
    * deviceLibrary -> R1.1.0
  * Update the following EPICS modules:
    * yamlLoader -> R1.1.3
    * yamlDownloader -> R1.1.0
    * YCpswAsyn -> R3.1.1
    * l2MpsAsyn -> R2.3.0

* __l2MpsLN-R2-2-0__: 2019-06-13 J. Vasquez
  * Add support for the LCLS-I operation related registers.

* __l2MpsLN-R2-1-0__: 2019-06-12 J. Vasquez
  * Update l2MpsAsyn to version R2.1.0.
  * Autosave files are build using the info(autosaveFields)
    defined in the databse. Am autosave file, with manually
    defined PVs was added.
  * Add Link Node for building 34.

* __l2MpsLN-R2-0-0__: 2019-02-28 J. Vasquez
  * Update CPSW framework to version R3.6.6, boost to 1.64.0 and
    yaml-cpp to yaml-cpp-0.5.3_boost-1.64.0.
  * Update l2Mps and l2MpsAsyn to version R2.0.0.
  * Update yamlLoader to R1.1.2 and YCPSWASYN to R3.0.5.
  * Use the yamlDownloader to get the YAML files from the FPGA.
  * Use AI record for the ADC values.
  * Set JesdRx.InvertAdcData = 0xF to invert the ADC data and
    revert the effect of the HW inverter present in the ADC card.
  * Add DEV IOC (sioc-b084-mp02).
  * Minor bug fixes and code clean ups.

* __l2MpsLN-R1-0-0__: 2018-07-18 J. Vasquez
  * First stable release for EIC.
